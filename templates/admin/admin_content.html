{% extends "base.html" %}

{% block title %}Content Moderation - Admin Dashboard{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
    <!-- Header -->
    <div class="bg-gradient-to-r from-red-600 to-red-700 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-4xl font-bold text-white flex items-center space-x-3">
                        <i class="fas fa-shield-alt"></i>
                        <span>Content Moderation</span>
                    </h1>
                    <p class="text-red-100 mt-2">Review and manage platform content</p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="bg-white rounded-xl px-6 py-4 shadow-lg">
                        <span class="text-sm font-semibold text-gray-700">Flagged Items:</span>
                        <span class="font-bold text-red-600 ml-2 text-2xl" id="flagged-count">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Type Tabs -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <div class="flex space-x-2 bg-white rounded-xl shadow-lg p-2">
            <button onclick="switchTab('businesses')" id="tab-businesses" class="tab-button active px-6 py-3 rounded-lg font-semibold text-white bg-gradient-to-r from-red-600 to-red-700 transition-all duration-300 hover:shadow-lg">
                <i class="fas fa-building mr-2"></i>Businesses
            </button>
            <button onclick="switchTab('jobs')" id="tab-jobs" class="tab-button px-6 py-3 rounded-lg font-semibold text-gray-700 hover:bg-gray-100 transition-all duration-300">
                <i class="fas fa-briefcase mr-2"></i>Job Postings
            </button>
            <button onclick="switchTab('services')" id="tab-services" class="tab-button px-6 py-3 rounded-lg font-semibold text-gray-700 hover:bg-gray-100 transition-all duration-300">
                <i class="fas fa-tools mr-2"></i>Services
            </button>
            <button onclick="switchTab('reviews')" id="tab-reviews" class="tab-button px-6 py-3 rounded-lg font-semibold text-gray-700 hover:bg-gray-100 transition-all duration-300">
                <i class="fas fa-star mr-2"></i>Reviews
            </button>
        </div>
    </div>

    <!-- Filters -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 p-8 mb-6">
            <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center space-x-2">
                <i class="fas fa-filter text-red-600"></i>
                <span>Filter Content</span>
            </h2>
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-semibold text-gray-700">Status:</label>
                    <select id="status-filter" class="px-4 py-2 border-2 border-red-300 rounded-lg focus:ring-red-500 focus:border-red-500 transition-all duration-300">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="flagged">Flagged</option>
                        <option value="hidden">Hidden</option>
                        <option value="removed">Removed</option>
                    </select>
                </div>
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-semibold text-gray-700">Search:</label>
                    <input type="text" id="search-input" placeholder="Search content..." 
                           class="px-4 py-2 border-2 border-red-300 rounded-lg focus:ring-red-500 focus:border-red-500 transition-all duration-300">
                </div>
                <button onclick="resetFilters()" class="bg-gradient-to-r from-red-600 to-red-700 text-white px-6 py-2 rounded-lg font-semibold transition-all duration-300 hover:shadow-lg">
                    <i class="fas fa-refresh mr-2"></i>Reset
            </button>
        </div>
    </div>

    <!-- Content Table -->
    <div class="admin-table-container">
        <div class="table-responsive">
            <table class="admin-table" id="content-table">
                <thead id="table-header">
                    <!-- Header will be populated based on active tab -->
                </thead>
                <tbody id="content-tbody">
                    <!-- Table rows will be populated here -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Content Detail Modal -->
<div id="content-modal" class="modal">
    <div class="modal-content modal-lg">
        <div class="modal-header">
            <h3 class="modal-title" id="modal-title">Content Details</h3>
            <button onclick="closeModal()" class="modal-close">&times;</button>
        </div>
        <div class="modal-body" id="modal-body">
            <!-- Content will be populated here -->
        </div>
        <div class="modal-footer">
            <button onclick="hideContent()" class="btn-warning">
                <i class="fas fa-eye-slash mr-2"></i>Hide Content
            </button>
            <button onclick="removeContent()" class="btn-danger">
                <i class="fas fa-trash mr-2"></i>Remove Content
            </button>
            <button onclick="restoreContent()" class="btn-success">
                <i class="fas fa-undo mr-2"></i>Restore Content
            </button>
        </div>
    </div>
</div>

<!-- Confirmation Modal -->
<div id="confirm-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="confirm-title">Confirm Action</h3>
            <button onclick="closeConfirmModal()" class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <p id="confirm-message">Are you sure you want to proceed?</p>
        </div>
        <div class="modal-footer">
            <button onclick="closeConfirmModal()" class="btn-secondary">Cancel</button>
            <button id="confirm-action" class="btn-primary">Confirm</button>
        </div>
    </div>
</div>

<script>
// Sample data for demonstration
let contentData = {
    businesses: [
        {
            id: 1,
            name: 'Santos Electronics',
            owner: 'Maria Santos',
            email: 'maria@santos.com',
            description: 'Quality electronics and repair services since 2010.',
            status: 'active',
            created: '2024-01-10',
            flagCount: 0,
            views: 245,
            rating: 4.5
        },
        {
            id: 2,
            name: 'Quick Fix Auto Shop',
            owner: 'John Reyes',
            email: 'john@quickfix.com',
            description: 'Fast and reliable auto repair services.',
            status: 'flagged',
            created: '2024-01-12',
            flagCount: 3,
            views: 189,
            rating: 3.2,
            flags: ['Inappropriate content', 'False advertising', 'Poor service']
        },
        {
            id: 3,
            name: 'Hidden Business',
            owner: 'Anonymous User',
            email: 'hidden@example.com',
            description: 'This business has been hidden.',
            status: 'hidden',
            created: '2024-01-08',
            flagCount: 0,
            views: 0,
            rating: 0
        }
    ],
    jobs: [
        {
            id: 1,
            title: 'Frontend Developer',
            company: 'Tech Solutions Inc.',
            employer: 'Carlos Mendez',
            email: 'carlos@techsol.com',
            description: 'Looking for experienced frontend developer with React skills.',
            status: 'active',
            created: '2024-01-15',
            applications: 12,
            salary: '₱30,000 - ₱50,000'
        },
        {
            id: 2,
            title: 'Waitress Needed',
            company: 'Local Restaurant',
            employer: 'Ana Cruz',
            email: 'ana@cafe.com',
            description: 'Part-time waitress position available immediately.',
            status: 'flagged',
            created: '2024-01-14',
            applications: 5,
            salary: '₱15,000',
            flags: ['Discriminatory language', 'Incomplete information']
        }
    ],
    services: [
        {
            id: 1,
            title: 'Plumbing Services',
            provider: 'Mike Plumbing',
            email: 'mike@plumbing.com',
            description: 'Professional plumbing services for residential and commercial.',
            status: 'active',
            created: '2024-01-11',
            bookings: 8,
            rating: 4.8,
            price: '₱500 - ₱2,000'
        },
        {
            id: 2,
            title: 'Home Cleaning',
            provider: 'Clean Team',
            email: 'info@clean.com',
            description: 'Professional home cleaning services.',
            status: 'flagged',
            created: '2024-01-13',
            bookings: 3,
            rating: 4.2,
            price: '₱300 - ₱800',
            flags: ['Fake reviews suspected']
        }
    ],
    reviews: [
        {
            id: 1,
            business: 'Santos Electronics',
            reviewer: 'Juan Dela Cruz',
            email: 'juan@email.com',
            rating: 5,
            comment: 'Excellent service! Fixed my laptop quickly and affordably.',
            status: 'active',
            created: '2024-01-16',
            helpful: 3
        },
        {
            id: 2,
            business: 'Quick Fix Auto Shop',
            reviewer: 'Maria Gomez',
            email: 'maria@email.com',
            rating: 1,
            comment: 'Terrible service! Overcharged and did a poor job.',
            status: 'flagged',
            created: '2024-01-15',
            helpful: 1,
            flags: ['Inappropriate language', 'Personal attack']
        }
    ]
};

let currentTab = 'businesses';
let currentContent = null;

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    switchTab('businesses');
    updateFlaggedCount();
    setupEventListeners();
});

function setupEventListeners() {
    document.getElementById('status-filter').addEventListener('change', filterContent);
    document.getElementById('search-input').addEventListener('input', filterContent);
}

function switchTab(tab) {
    currentTab = tab;
    
    // Update tab buttons
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
    });
    document.getElementById(`tab-${tab}`).classList.add('active');
    
    // Update table header and render content
    updateTableHeader();
    renderContentTable();
}

function updateTableHeader() {
    const header = document.getElementById('table-header');
    
    const headers = {
        businesses: `
            <tr>
                <th>Business</th>
                <th>Owner</th>
                <th>Status</th>
                <th>Rating</th>
                <th>Views</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        `,
        jobs: `
            <tr>
                <th>Job Title</th>
                <th>Company</th>
                <th>Employer</th>
                <th>Status</th>
                <th>Applications</th>
                <th>Salary</th>
                <th>Actions</th>
            </tr>
        `,
        services: `
            <tr>
                <th>Service</th>
                <th>Provider</th>
                <th>Status</th>
                <th>Rating</th>
                <th>Bookings</th>
                <th>Price</th>
                <th>Actions</th>
            </tr>
        `,
        reviews: `
            <tr>
                <th>Business</th>
                <th>Reviewer</th>
                <th>Rating</th>
                <th>Comment</th>
                <th>Status</th>
                <th>Helpful</th>
                <th>Actions</th>
            </tr>
        `
    };
    
    header.innerHTML = headers[tab];
}

function renderContentTable() {
    const tbody = document.getElementById('content-tbody');
    const data = contentData[currentTab];
    
    tbody.innerHTML = '';
    
    data.forEach(item => {
        const row = document.createElement('tr');
        
        if (currentTab === 'businesses') {
            row.innerHTML = `
                <td>
                    <div class="flex items-center">
                        <div class="avatar-sm bg-blue-100 text-blue-600 mr-3">
                            ${item.name.charAt(0)}
                        </div>
                        <div>
                            <div class="font-medium text-gray-900">${item.name}</div>
                            <div class="text-sm text-gray-500">${item.description.substring(0, 50)}...</div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="text-sm text-gray-900">${item.owner}</div>
                    <div class="text-sm text-gray-500">${item.email}</div>
                </td>
                <td>
                    <span class="badge badge-${getStatusColor(item.status)}">
                        ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
                    </span>
                    ${item.flagCount > 0 ? `<span class="ml-2 text-red-600 text-sm">(${item.flagCount})</span>` : ''}
                </td>
                <td>
                    <div class="flex items-center">
                        ${generateStars(item.rating)}
                        <span class="ml-1 text-sm text-gray-600">${item.rating}</span>
                    </div>
                </td>
                <td class="text-sm text-gray-900">${item.views}</td>
                <td class="text-sm text-gray-900">${formatDate(item.created)}</td>
                <td>
                    <button onclick="viewContentDetails(${item.id})" class="btn-info btn-sm">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
        } else if (currentTab === 'jobs') {
            row.innerHTML = `
                <td>
                    <div class="font-medium text-gray-900">${item.title}</div>
                    <div class="text-sm text-gray-500">${item.description.substring(0, 50)}...</div>
                </td>
                <td class="text-sm text-gray-900">${item.company}</td>
                <td>
                    <div class="text-sm text-gray-900">${item.employer}</div>
                    <div class="text-sm text-gray-500">${item.email}</div>
                </td>
                <td>
                    <span class="badge badge-${getStatusColor(item.status)}">
                        ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
                    </span>
                </td>
                <td class="text-sm text-gray-900">${item.applications}</td>
                <td class="text-sm text-gray-900">${item.salary}</td>
                <td>
                    <button onclick="viewContentDetails(${item.id})" class="btn-info btn-sm">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
        } else if (currentTab === 'services') {
            row.innerHTML = `
                <td>
                    <div class="font-medium text-gray-900">${item.title}</div>
                    <div class="text-sm text-gray-500">${item.description.substring(0, 50)}...</div>
                </td>
                <td>
                    <div class="text-sm text-gray-900">${item.provider}</div>
                    <div class="text-sm text-gray-500">${item.email}</div>
                </td>
                <td>
                    <span class="badge badge-${getStatusColor(item.status)}">
                        ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
                    </span>
                </td>
                <td>
                    <div class="flex items-center">
                        ${generateStars(item.rating)}
                        <span class="ml-1 text-sm text-gray-600">${item.rating}</span>
                    </div>
                </td>
                <td class="text-sm text-gray-900">${item.bookings}</td>
                <td class="text-sm text-gray-900">${item.price}</td>
                <td>
                    <button onclick="viewContentDetails(${item.id})" class="btn-info btn-sm">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
        } else if (currentTab === 'reviews') {
            row.innerHTML = `
                <td class="text-sm text-gray-900">${item.business}</td>
                <td>
                    <div class="text-sm text-gray-900">${item.reviewer}</div>
                    <div class="text-sm text-gray-500">${item.email}</div>
                </td>
                <td>
                    <div class="flex items-center">
                        ${generateStars(item.rating)}
                        <span class="ml-1 text-sm text-gray-600">${item.rating}</span>
                    </div>
                </td>
                <td class="text-sm text-gray-900 max-w-xs">
                    ${item.comment.length > 100 ? item.comment.substring(0, 100) + '...' : item.comment}
                </td>
                <td>
                    <span class="badge badge-${getStatusColor(item.status)}">
                        ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
                    </span>
                </td>
                <td class="text-sm text-gray-900">${item.helpful}</td>
                <td>
                    <button onclick="viewContentDetails(${item.id})" class="btn-info btn-sm">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
        }
        
        tbody.appendChild(row);
    });
}

function getStatusColor(status) {
    const colors = {
        'active': 'success',
        'flagged': 'warning',
        'hidden': 'secondary',
        'removed': 'danger'
    };
    return colors[status] || 'secondary';
}

function generateStars(rating) {
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 !== 0;
    let stars = '';
    
    for (let i = 0; i < fullStars; i++) {
        stars += '<i class="fas fa-star text-yellow-400"></i>';
    }
    
    if (hasHalfStar) {
        stars += '<i class="fas fa-star-half-alt text-yellow-400"></i>';
    }
    
    const emptyStars = 5 - Math.ceil(rating);
    for (let i = 0; i < emptyStars; i++) {
        stars += '<i class="far fa-star text-yellow-400"></i>';
    }
    
    return stars;
}

function formatDate(dateString) {
    return new Date(dateString).toLocaleDateString();
}

function filterContent() {
    const statusFilter = document.getElementById('status-filter').value;
    const searchTerm = document.getElementById('search-input').value.toLowerCase();
    
    const data = contentData[currentTab].filter(item => {
        const matchesStatus = !statusFilter || item.status === statusFilter;
        
        let matchesSearch = true;
        if (searchTerm) {
            if (currentTab === 'businesses') {
                matchesSearch = item.name.toLowerCase().includes(searchTerm) ||
                               item.owner.toLowerCase().includes(searchTerm) ||
                               item.description.toLowerCase().includes(searchTerm);
            } else if (currentTab === 'jobs') {
                matchesSearch = item.title.toLowerCase().includes(searchTerm) ||
                               item.company.toLowerCase().includes(searchTerm) ||
                               item.description.toLowerCase().includes(searchTerm);
            } else if (currentTab === 'services') {
                matchesSearch = item.title.toLowerCase().includes(searchTerm) ||
                               item.provider.toLowerCase().includes(searchTerm) ||
                               item.description.toLowerCase().includes(searchTerm);
            } else if (currentTab === 'reviews') {
                matchesSearch = item.business.toLowerCase().includes(searchTerm) ||
                               item.reviewer.toLowerCase().includes(searchTerm) ||
                               item.comment.toLowerCase().includes(searchTerm);
            }
        }
        
        return matchesStatus && matchesSearch;
    });
    
    renderFilteredTable(data);
}

function renderFilteredTable(data) {
    const tbody = document.getElementById('content-tbody');
    tbody.innerHTML = '';
    
    data.forEach(item => {
        const row = document.createElement('tr');
        
        if (currentTab === 'businesses') {
            row.innerHTML = `
                <td>
                    <div class="flex items-center">
                        <div class="avatar-sm bg-blue-100 text-blue-600 mr-3">
                            ${item.name.charAt(0)}
                        </div>
                        <div>
                            <div class="font-medium text-gray-900">${item.name}</div>
                            <div class="text-sm text-gray-500">${item.description.substring(0, 50)}...</div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="text-sm text-gray-900">${item.owner}</div>
                    <div class="text-sm text-gray-500">${item.email}</div>
                </td>
                <td>
                    <span class="badge badge-${getStatusColor(item.status)}">
                        ${item.status.charAt(0).toUpperCase() + item.status.slice(1)}
                    </span>
                    ${item.flagCount > 0 ? `<span class="ml-2 text-red-600 text-sm">(${item.flagCount})</span>` : ''}
                </td>
                <td>
                    <div class="flex items-center">
                        ${generateStars(item.rating)}
                        <span class="ml-1 text-sm text-gray-600">${item.rating}</span>
                    </div>
                </td>
                <td class="text-sm text-gray-900">${item.views}</td>
                <td class="text-sm text-gray-900">${formatDate(item.created)}</td>
                <td>
                    <button onclick="viewContentDetails(${item.id})" class="btn-info btn-sm">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
        }
        
        tbody.appendChild(row);
    });
}

function resetFilters() {
    document.getElementById('status-filter').value = '';
    document.getElementById('search-input').value = '';
    renderContentTable();
}

function updateFlaggedCount() {
    let totalFlagged = 0;
    Object.values(contentData).forEach(data => {
        data.forEach(item => {
            if (item.status === 'flagged') {
                totalFlagged++;
            }
        });
    });
    document.getElementById('flagged-count').textContent = totalFlagged;
}

function viewContentDetails(id) {
    currentContent = contentData[currentTab].find(item => item.id === id);
    if (!currentContent) return;
    
    const modalBody = document.getElementById('modal-body');
    const modalTitle = document.getElementById('modal-title');
    
    modalTitle.textContent = `${currentTab.charAt(0).toUpperCase() + currentTab.slice(1)} Details`;
    
    let content = '';
    
    if (currentTab === 'businesses') {
        content = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Business Information</h4>
                    <div class="space-y-2">
                        <div><strong>Name:</strong> ${currentContent.name}</div>
                        <div><strong>Owner:</strong> ${currentContent.owner}</div>
                        <div><strong>Email:</strong> ${currentContent.email}</div>
                        <div><strong>Created:</strong> ${formatDate(currentContent.created)}</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Statistics</h4>
                    <div class="space-y-2">
                        <div><strong>Rating:</strong> ${currentContent.rating}/5</div>
                        <div><strong>Views:</strong> ${currentContent.views}</div>
                        <div><strong>Status:</strong> 
                            <span class="badge badge-${getStatusColor(currentContent.status)}">
                                ${currentContent.status.charAt(0).toUpperCase() + currentContent.status.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-3">Description</h4>
                <p class="text-gray-700">${currentContent.description}</p>
            </div>
        `;
    } else if (currentTab === 'jobs') {
        content = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Job Information</h4>
                    <div class="space-y-2">
                        <div><strong>Title:</strong> ${currentContent.title}</div>
                        <div><strong>Company:</strong> ${currentContent.company}</div>
                        <div><strong>Employer:</strong> ${currentContent.employer}</div>
                        <div><strong>Email:</strong> ${currentContent.email}</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Statistics</h4>
                    <div class="space-y-2">
                        <div><strong>Applications:</strong> ${currentContent.applications}</div>
                        <div><strong>Salary:</strong> ${currentContent.salary}</div>
                        <div><strong>Status:</strong> 
                            <span class="badge badge-${getStatusColor(currentContent.status)}">
                                ${currentContent.status.charAt(0).toUpperCase() + currentContent.status.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-3">Description</h4>
                <p class="text-gray-700">${currentContent.description}</p>
            </div>
        `;
    } else if (currentTab === 'services') {
        content = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Service Information</h4>
                    <div class="space-y-2">
                        <div><strong>Title:</strong> ${currentContent.title}</div>
                        <div><strong>Provider:</strong> ${currentContent.provider}</div>
                        <div><strong>Email:</strong> ${currentContent.email}</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Statistics</h4>
                    <div class="space-y-2">
                        <div><strong>Rating:</strong> ${currentContent.rating}/5</div>
                        <div><strong>Bookings:</strong> ${currentContent.bookings}</div>
                        <div><strong>Price:</strong> ${currentContent.price}</div>
                        <div><strong>Status:</strong> 
                            <span class="badge badge-${getStatusColor(currentContent.status)}">
                                ${currentContent.status.charAt(0).toUpperCase() + currentContent.status.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-3">Description</h4>
                <p class="text-gray-700">${currentContent.description}</p>
            </div>
        `;
    } else if (currentTab === 'reviews') {
        content = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Review Information</h4>
                    <div class="space-y-2">
                        <div><strong>Business:</strong> ${currentContent.business}</div>
                        <div><strong>Reviewer:</strong> ${currentContent.reviewer}</div>
                        <div><strong>Email:</strong> ${currentContent.email}</div>
                        <div><strong>Created:</strong> ${formatDate(currentContent.created)}</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-gray-900 mb-3">Statistics</h4>
                    <div class="space-y-2">
                        <div><strong>Rating:</strong> ${currentContent.rating}/5</div>
                        <div><strong>Helpful:</strong> ${currentContent.helpful}</div>
                        <div><strong>Status:</strong> 
                            <span class="badge badge-${getStatusColor(currentContent.status)}">
                                ${currentContent.status.charAt(0).toUpperCase() + currentContent.status.slice(1)}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-gray-900 mb-3">Review Comment</h4>
                <p class="text-gray-700">${currentContent.comment}</p>
            </div>
        `;
    }
    
    if (currentContent.flags && currentContent.flags.length > 0) {
        content += `
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-red-600 mb-3">Flags</h4>
                <div class="space-y-2">
                    ${currentContent.flags.map(flag => `
                        <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                            <div class="flex items-center">
                                <i class="fas fa-flag text-red-500 mr-2"></i>
                                <span class="text-red-700">${flag}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    }
    
    modalBody.innerHTML = content;
    document.getElementById('content-modal').style.display = 'flex';
}

function closeModal() {
    document.getElementById('content-modal').style.display = 'none';
    currentContent = null;
}

function hideContent() {
    if (currentContent) {
        showConfirmModal('Hide Content', 'Are you sure you want to hide this content?', () => {
            currentContent.status = 'hidden';
            renderContentTable();
            updateFlaggedCount();
            closeModal();
            showNotification('Content hidden successfully', 'success');
        });
    }
}

function removeContent() {
    if (currentContent) {
        showConfirmModal('Remove Content', 'Are you sure you want to remove this content? This action cannot be undone.', () => {
            currentContent.status = 'removed';
            renderContentTable();
            updateFlaggedCount();
            closeModal();
            showNotification('Content removed successfully', 'success');
        });
    }
}

function restoreContent() {
    if (currentContent) {
        showConfirmModal('Restore Content', 'Are you sure you want to restore this content?', () => {
            currentContent.status = 'active';
            renderContentTable();
            updateFlaggedCount();
            closeModal();
            showNotification('Content restored successfully', 'success');
        });
    }
}

function showConfirmModal(title, message, callback) {
    document.getElementById('confirm-title').textContent = title;
    document.getElementById('confirm-message').textContent = message;
    document.getElementById('confirm-modal').style.display = 'flex';
    
    const confirmButton = document.getElementById('confirm-action');
    confirmButton.onclick = () => {
        callback();
        closeConfirmModal();
    };
}

function closeConfirmModal() {
    document.getElementById('confirm-modal').style.display = 'none';
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
        <div class="flex items-center">
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'} mr-2"></i>
            <span>${message}</span>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>

<style>
.admin-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}

.admin-header {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e5e7eb;
}

.admin-tabs {
    margin-bottom: 2rem;
}

.tab-button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.375rem;
    font-weight: 500;
    transition: all 0.2s;
    background: transparent;
    color: #6b7280;
    border: none;
    cursor: pointer;
}

.tab-button:hover {
    background: #e5e7eb;
    color: #374151;
}

.tab-button.active {
    background: #3b82f6;
    color: white;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.admin-filters {
    background: white;
    padding: 1.5rem;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

.admin-table-container {
    background: white;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    overflow: hidden;
}

.admin-table {
    width: 100%;
    border-collapse: collapse;
}

.admin-table th {
    background: #f9fafb;
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 1px solid #e5e7eb;
}

.admin-table td {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
    vertical-align: top;
}

.admin-table tbody tr:hover {
    background: #f9fafb;
}

.avatar-sm {
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
}

.badge {
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
}

.badge-success { background: #d1fae5; color: #065f46; }
.badge-warning { background: #fef3c7; color: #92400e; }
.badge-danger { background: #fee2e2; color: #991b1b; }
.badge-secondary { background: #f3f4f6; color: #374151; }

.btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
}

.notification {
    position: fixed;
    top: 2rem;
    right: 2rem;
    padding: 1rem 1.5rem;
    border-radius: 0.5rem;
    color: white;
    font-weight: 500;
    z-index: 2000;
    animation: slideIn 0.3s ease;
}

.notification-success { background: #10b981; }
.notification-info { background: #3b82f6; }
.notification-warning { background: #f59e0b; }
.notification-danger { background: #ef4444; }

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@media (max-width: 768px) {
    .admin-container {
        padding: 1rem;
    }
    
    .admin-tabs .flex {
        flex-direction: column;
    }
    
    .tab-button {
        margin-bottom: 0.5rem;
    }
    
    .admin-filters {
        padding: 1rem;
    }
    
    .admin-filters .flex {
        flex-direction: column;
        align-items: stretch;
    }
    
    .admin-filters .flex > div {
        width: 100%;
    }
    
    .table-responsive {
        overflow-x: auto;
    }
}
</style>
{% endblock %}